import Joi from "joi"
import passwordComplexity from "joi-password-complexity"
import { InputValidationError } from "~/errors/input-validation-error"

const allowedTopLevelDomains = [
  "ac",
  "academy",
  "ad",
  "ae",
  "agency",
  "ai",
  "al",
  "am",
  "amsterdam",
  "ar",
  "art",
  "asia",
  "at",
  "au",
  "aw",
  "ax",
  "az",
  "bb",
  "be",
  "bg",
  "bh",
  "biz",
  "bm",
  "bn",
  "br",
  "bs",
  "ca",
  "cat",
  "cc",
  "center",
  "ch",
  "chat",
  "church",
  "ck",
  "cl",
  "cloud",
  "club",
  "cm",
  "cn",
  "co",
  "com",
  "coop",
  "cr",
  "cw",
  "cx",
  "cy",
  "cz",
  "de",
  "design",
  "dk",
  "do",
  "ec",
  "edu",
  "education",
  "ee",
  "eg",
  "email",
  "er",
  "es",
  "et",
  "eu",
  "eus",
  "fi",
  "fj",
  "fm",
  "fo",
  "fr",
  "ga",
  "gg",
  "gh",
  "glass",
  "global",
  "gov",
  "gr",
  "gs",
  "gt",
  "hk",
  "hn",
  "house",
  "hr",
  "ht",
  "hu",
  "id",
  "ie",
  "il",
  "im",
  "in",
  "info",
  "io",
  "is",
  "it",
  "je",
  "jo",
  "jp",
  "ke",
  "kh",
  "kr",
  "kw",
  "ky",
  "kz",
  "lb",
  "life",
  "lk",
  "london",
  "lu",
  "lv",
  "ma",
  "mc",
  "me",
  "mil",
  "ml",
  "mn",
  "mo",
  "ms",
  "mt",
  "mu",
  "museum",
  "mw",
  "mx",
  "my",
  "na",
  "nc",
  "ne",
  "net",
  "nf",
  "ng",
  "ni",
  "nl",
  "no",
  "nu",
  "nyc",
  "nz",
  "om",
  "one",
  "online",
  "org",
  "pa",
  "pe",
  "pg",
  "ph",
  "pk",
  "pl",
  "pr",
  "pro",
  "ps",
  "pt",
  "py",
  "qa",
  "ro",
  "rs",
  "ru",
  "sa",
  "sc",
  "school",
  "se",
  "sg",
  "sh",
  "si",
  "site",
  "sn",
  "space",
  "st",
  "studio",
  "su",
  "sv",
  "sz",
  "tc",
  "th",
  "tips",
  "tn",
  "top",
  "tr",
  "tt",
  "tw",
  "tz",
  "ua",
  "uk",
  "us",
  "uz",
  "va",
  "ve",
  "vi",
  "vn",
  "world",
  "ws",
  "za",
  "zw"
]

const email = Joi
  .string()
  .email({ tlds: { allow: allowedTopLevelDomains } })
  .trim()
  .error(() => new InputValidationError("Must be a valid email address"))

const password = passwordComplexity({
    min: 8,
    max: 1024,
    upperCase: 1,
    lowerCase: 1,
    numeric: 1
  })
  .required()
  .error(() => new InputValidationError("Password must be at least 8 characters, and must have at least one uppercase, one lowercase, and one numeric character."))

export const login = {
  email,
  password
}
